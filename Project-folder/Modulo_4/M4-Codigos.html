<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Códigos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="Css/Codigos/S01-General.css">
    <link rel="stylesheet" href="Css/Codigos/S02-Search.css">
    <link rel="stylesheet" href="Css/Codigos/S03-New.css">
    <link rel="stylesheet" href="Css/Codigos/S04-Register.css">
    <link rel="stylesheet" href="Css/Codigos/S05-Table.css">
    <link rel="stylesheet" href="Css/Codigos/S06-Pagination.css">
    <link rel="stylesheet" href="Css/Codigos/S07-Management.css">
    <link rel="stylesheet" href="Css/Codigos/S08-Messages.css">
    <link rel="stylesheet" href="Css/Codigos/S09-Import.css">
    <link rel="stylesheet" href="Css/Codigos/S10-Delet.css">
    <link rel="stylesheet" href="Css/Codigos/S11-Spinner.css">
    <link rel="stylesheet" href="Css/Codigos/S12-Edit.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>  
</head>
<body>

    <div class="container" id="main-container">
        <h1 id="main-title"> * (BD) Códigos <i class="fas fa-check-circle fa-lg"></i></h1>

        <div id="user-name-container" class="user-name" style="display: none;">
            <span id="user-name-span">Cargando usuario...</span>
        </div>

        <script type="module" src="Script/M4-Codigos/S10-User.js"></script>
               
        <div class="division" id="division-line"></div>   
        
        <div class="form-search-container" id="searchContainer">
            <h2 id="search-title">Buscar Códigos</h2>
            <div class="form-row-search" id="search-row">
                <div class="form-group-search" id="search-reference">
                    <label for="searchReference">Buscar por referencia</label>
                    <input type="text" id="searchReference" placeholder="Ingrese la referencia">
                </div>
                <div class="form-group-search" id="search-details">
                    <label for="searchDetails">Buscar por detalles</label>
                    <input type="text" id="searchDetails" placeholder="Ingrese el detalle">
                </div>
                <div class="form-group-search" id="search-code">
                    <label for="searchCode">Buscar por códigos</label>
                    <input type="text" id="searchCode" placeholder="Ingrese el código">
                </div>
                <div class="form-group-search" id="search-provider">
                    <label for="searchProvider">Buscar por proveedor</label>
                    <input type="text" id="searchProvider" placeholder="Ingrese el proveedor">
                </div>
            </div>
        </div>

        <div class="form-new-container" id="formNewContainer"> 
            <button id="bttnNew" class="bttn-new">Registrar nuevo código<i class="fas fa-plus-circle"></i></button>
            <span class="bttn-text" id="new-text">
                <i class="fas fa-arrow-left fa-lg"></i> Presiona "NUEVO" para registrar un nuevo contacto.
            </span>
        </div>

        <form class="form-register-container hidden" id="formRegisterContainer">
            <h2 id="register-title">Formulario de Registro</h2>
            <div class="form-row-register" id="register-row">

                <div class="form-group-register" id="register-usuario">
                    <label for="registerUsuario" style="font-size: 12px;">Digitado por:</label>
                    <span id="registerUsuario" style="font-size: 10px;"></span>
                </div>

                <div class="form-group-register" id="register-reference">
                    <label for="registerReference">Referencia</label>
                    <input type="text" id="registerReference" placeholder="Ingrese la referencia" required>
                </div>

                <div class="form-group-register" id="register-details">
                    <label for="registerDetails">Detalles</label>
                    <input type="text" id="registerDetails" placeholder="Ingrese el detalle" required>
                </div>

                <div class="form-group-register" id="register-cost">
                    <label for="registerCost">Costo</label>
                    <input type="text" id="registerCost" placeholder="Ingrese el costo" required>
                </div>

                <div class="form-group-register" id="register-code">
                    <label for="registerCode">Código</label>
                    <input type="text" id="registerCode" placeholder="Ingrese el código">
                </div>

                <div class="form-group-register" id="register-clinic">
                    <label for="registerClinic">Clínica</label>
                    <span id="registerClinic">LIRCAY</span>
                </div>
                
                <div class="form-group-register" id="register-provider">
                    <label for="registerProvider">Proveedor</label>
                    <select id="registerProvider">
                        <option value="">Selecciona una empresa</option>
                    </select>
                </div>

                <div class="form-group-register" id="register-description">
                    <label for="registerDescription">Descripción</label>
                    <span id="registerDescription"></span>
                </div>

                <div class="form-group-register" id="register-atribute">
                    <label for="registerAtribute">Atributo</label>
                    <span id="atribute">IMPLANTES</span>
                </div>

                <div class="form-group-register" id="register-price">
                    <label for="registerPrice">Precio</label>
                    <span id="registerPrice"></span>
                </div>

                <div class="form-group-register" id="register-classification">
                    <label for="registerClassification">Clasificación</label>
                    <select id="registerClassification">
                        <option value="Implantes">Implantes</option>
                        <option value="Consignacion">Consignación</option>
                    </select>
                </div>

                <div class="bttn-container-register" id="register-button-container">
                    <button type="submit" class="btn-save-register" id="btnSave">
                        <i class="fas fa-save"></i> Guardar
                    </button>
                    <button type="reset" class="btn-reset-register" id="btnReset">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                </div>
            </div>
        </form>


        <script>
            const inputUsuario = document.getElementById('registerUsuario');
            inputUsuario.setAttribute('readonly', true);
        </script>

        <div class="table-container" id="tableContainer">
            <div class="tabs">
                <button class="tab-button" id="tab-database" onclick="showTab('database')">Base de Datos</button>
                <button class="tab-button" id="tab-pending-codes" onclick="showTab('pending-codes')">Códigos Pendientes</button>
            </div>

            <div class="tab-content">
                <div id="tab-database-content" class="tab-content-section">
                    <table id="BaseDatos">
                        <thead id="tableHeader">
                            <tr>
                                <th>Acción</th>
                                <th>Id <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Referencia <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Detalles <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Costo <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Código <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Clínica <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Proveedor <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Descripción <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Atributo <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Precio <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Clasificación <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Fecha Creación <i class="fas fa-sort-alpha-down"></i></th>
                                <th>Usuario <i class="fas fa-sort-alpha-down"></i></th>
                            </tr>
                        </thead>
                        <tbody id="table-body"></tbody>
                    </table>

                    <div id="paginationControls">
                        <button id="prevBtn" style="display:none;">Anterior</button>
                        <button id="nextBtn" style="display:none;">Siguiente</button>
                    </div>
                </div>

                <div id="tab-pending-codes-content" class="tab-content-section" style="display:none;">
                    <table id="PendingCodes">
                        <thead id="tableHeader">
                            <tr>
                                <th>Acción</th>
                                <th>Id</th>
                                <th>Referencia</th>
                                <th>Detalles</th>
                                <th>Costo</th>
                                <th>Código</th>
                                <th>Clínica</th>
                                <th>Proveedor</th>
                                <th>Descripción</th>
                                <th>Atributo</th>
                                <th>Precio</th>
                                <th>Clasificación</th>
                                <th>Fecha Creación</th>
                                <th>Usuario</th>
                            </tr>
                        </thead>
                        <tbody id="pending-codes-body"></tbody>
                    </table>

                    <div id="pendingPaginationControls">
                        <button id="prevPendingBtn" style="display:none;">Anterior</button>
                        <button id="nextPendingBtn" style="display:none;">Siguiente</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="download-container" id="downloadContainer"> 
            <button id="bttnDownload" class="bttn-download">Descargar Excel <i class="fas fa-download"></i></button>
            <button id="bttnImport" class="bttn-import">Importar Excel <i class="fas fa-upload"></i></button>
        </div>

        <div class="import-container hidden" id="importContainer">
            <div class="import-content">
                <div class="form-group-import" id="import-usuario">
                    <label for="importUsuario" style="font-size: 12px;">Importado por:</label>
                    <span id="importUsuario" style="font-size: 10px;">Nombre del usuario</span>
                    <button class="close-btn-import" id="close-import-container">×</button>
                </div>
                <div class="form-group-import">
                    <label for="fileInput">Subir archivo:</label>
                    <input type="file" id="fileInput" class="file-input">
                    <span>Selecciona un archivo .xlsx o .csv</span>
                </div>
                <button class="btn-import" id="btnImportar">Importar</button>
                <button class="btn-cancelar-import" id="btnCancelar">Cancelar</button>
        
                <div class="overlay hidden" id="spinnerOverlay">
                    <div class="spinner-container" id="spinnerContainer">
                        <div class="loading-text" id="loadingText">Importando... </div>
                        <div class="lds-dual-ring" id="spinner"></div>
                    </div>
                </div>
            </div>
        </div> 

        <div class="messages-container" id="messagesContainer">
            <div class="message success hidden" id="messageSuccess">
              <i class="fas fa-check-circle"></i>
              <div class="text" id="successText"></div>
              <button class="close-btn" id="closeMessageSuccess">&times;</button>
            </div>
            <div class="message warning hidden" id="messageWarning">
              <i class="fas fa-exclamation-circle"></i>
              <div class="text" id="warningText">Advertencia:</div>
              <button class="close-btn" id="closeMessageWarning">&times;</button>
            </div>
            <div class="message error hidden" id="messageError">
              <i class="fas fa-times-circle"></i>
              <div class="text" id="errorText">Error: </div>
              <button class="close-btn" id="closeMessageError">&times;</button>
            </div>
            <div class="message info hidden" id="messageInfo">
              <i class="fas fa-info-circle"></i>
              <div class="text" id="infoText">Información: </div>
              <button class="close-btn" id="closeMessageInfo">&times;</button>
            </div>
        </div>

        <div class="delete-container hidden" id="deleteContainer">
            <div class="delete-form" id="deleteForm">
                <h3 id="deleteTitle">¿Estás seguro de que deseas eliminar esta selección?</h3>
                <div class="delete-buttons" id="deleteButtons">
                    <button id="btnConfirmarEliminar"><i class="fas fa-trash-alt"></i> Eliminar</button>
                    <button id="btnCancelarEliminar"><i class="fas fa-times"></i> Cancelar</button>
                </div>
            </div>
        </div>

        <div class="overlay hidden" id="overlay">
            <div class="spinner-container" id="spinnerContainer">
                <div class="lds-dual-ring" id="spinner"></div>
                <div class="loading-text" id="loadingText">Registrando...</div>
            </div>
        </div>
        
    </div>
    
    <script type="module" src="Script/M4-Codigos/S01-Firebase.js"></script>
    <script type="module" src="Script/M4-Codigos/S02-LoadEmpresas.js"></script>
    <script type="module" src=""></script>
    <script type="module" src="Script/M4-Codigos/S04-RegisterBD.js"></script>
    <script type="module" src=""></script>
    <script type="module" src="Script/M4-Codigos/S06-FormatoConcatenar.js"></script>
    <script type="module" src="Script/M4-Codigos/S07-ToggleForm.js"></script>
    <script src="Script/M4-Codigos/S08-Table.js"></script>
    <script type="module" src="Script/M4-Codigos/S09-Paginacion.js"></script>
    
</body>
</html>
